function color(){var t=0;$(".main-table > tbody > tr").each(function(){$(this).removeClass("strip"),$(this).hasClass("hidden")||$(this).hasClass("filterHidden")||t++%2&&$(this).addClass("strip")})}function contactFilter(){if($("#checkAll").hasClass("active"))return void $("table.basic-table > tbody").each(function(){var t=$(this).parents(".nameCard").attr("id");$("tr[data-target=#"+t+"]").removeClass("filterHidden")});var t=$("input:checked"),a={sex:{male:"男",female:"女",unknown:""},grade:{one:"大一",two:"大二",three:"大三",four:"大四",master:"研究生",work:"工作",unknown:""},group:{TG:"TG",OG:"OG",CG:"CG",PG:"PG",unknown:""},campus:{zijingang:"紫金港",yuquan:"玉泉",xixi:"西溪",huajiachi:"华家池",zhijiang:"之江",unknown:""}},n={},e,i,o=["sex","grade","group","campus"],r;for(var c in o)r=o[c],n[r]=[];t.each(function(){e=$(this).parents(".filterbox").attr("id"),n[e].push($(this).val())}),$("table.basic-table > tbody").each(function(){i=$(this).parents(".nameCard").attr("id");var t=$(this),e=o.every(function(e){var i=t.find("td[name="+e+"]").text();return n[e].some(function(t){return a[e][t]===i})});e?$("tr[data-target=#"+i+"]").removeClass("filterHidden"):$("tr[data-target=#"+i+"]").addClass("filterHidden")})}function changeBox(t){var a=["sid","sex","major","grade","campus","enrollTime","group","nickname","longNumber","shortNumber","email","qq"],n=$("#"+t),e=$("#changeBox");e.find("input[name=_id]").val(t),e.find(".modal-title").text(n.find(".modal-title").text()),a.forEach(function(t){e.find("[name="+t+"]").val(n.find("td[name="+t+"]").text())}),e.modal("toggle")}function firstLogin(){0!==$("#flag").length&&changeBox($("#flag").text())}$("#main .navbar-nav #list-main").addClass("active"),$("button[name=loginSubmit]").on("click",function(t){t.preventDefault();var a=$(this).parents("form"),n=a.find("input[name=username]"),e=n.val(),i=e.indexOf("@");-1!==i&&(e=e.substring(0,i)),n.val(e.toLowerCase()),a.submit()}),$(":checkbox").on("click",function(){var t=$("input[name=search]").val();t&&$("input[name=search]").val(""),0===$("input:checkbox:not(:checked)").length?$("#checkAll").addClass("active"):$("#checkAll").removeClass("active"),contactFilter(),color()}),$("#checkAll").on("click",function(){$(this).addClass("active"),$(":checkbox").each(function(){$(this).prop("checked","true")}),contactFilter(),color()}),$("input[name=search]").keyup(function(){var t=$("input[name=search]").val(),a=new RegExp(t,"i");$("table.main-table > tbody > tr").each(function(){var t=$(this).children().some(function(t){return a.test($(t).text())});t?$(this).removeClass("hidden"):$(this).addClass("hidden")}),color()}),$(".author").tooltip(),$("button[name=update]").on("click",function(){$("#changeBox form").submit()}),$(".nameCard button[name=change]").on("click",function(){$(this).parents(".nameCard").modal("hide");var t=$(this).attr("data-id"),a=function(){changeBox(t)};setTimeout(a,600)}),$("#csv, #xlsx, #xls").on("click",function(){var t=$("form#export"),a=0,n='<input name = "type" value = "'+$(this).attr("id")+'">';t.append(n),$(".main-table tbody tr").each(function(){if(!$(this).hasClass("hidden")&&!$(this).hasClass("filterHidden")){var n=$(this).attr("data-id"),e='<input name = "'+a+'" value = "'+n+'">';a++,t.append(e)}}),t.submit(),t.find("input").remove()}),$("#main #navExport").removeClass("hidden"),$(document).ready(function(){contactFilter(),color(),firstLogin()});