function color(){var t=0;$(".main-table > tbody > tr").each(function(){$(this).removeClass("strip"),$(this).hasClass("hidden")||$(this).hasClass("filterHidden")||t++%2&&$(this).addClass("strip")})}function contactFilter(){if($("#checkAll").hasClass("active"))return void $("table.basic-table > tbody").each(function(){var t=$(this).parents(".nameCard").attr("id");$("tr[data-target=#"+t+"]").removeClass("filterHidden")});var t=$("input:checked"),a={sex:{male:"男",female:"女"},grade:{one:"大一",two:"大二",three:"大三",four:"大四",master:"研究生",work:"工作"},group:{TG:"TG",OG:"OG",CG:"CG",PG:"PG"},campus:{zijingang:"紫金港",yuquan:"玉泉",xixi:"西溪",huajiachi:"华家池",zhijiang:"之江"}},e={},n,i=!1,c,o=["sex","grade","group","campus"],r;for(var s in o)r=o[s],e[r]=[];t.each(function(){n=$(this).parents(".filterbox").attr("id"),e[n].push($(this).val())}),$("table.basic-table > tbody").each(function(){c=$(this).parents(".nameCard").attr("id");for(var t in o)if(i=!1,r=o[t],$(this).find("td[name="+r+"]").each(function(){for(var t=0;t<e[r].length;t++){var n=e[r][t];a[r][n]===$(this).text()&&(i=!0)}}),!i)break;i?$("tr[data-target=#"+c+"]").removeClass("filterHidden"):$("tr[data-target=#"+c+"]").addClass("filterHidden")})}function changeBox(t){var a=[],e,n=["sid","sex","major","grade","campus","enrollTime","group","nickname","longNumber","shortNumber","email","qq"];$("#"+t).each(function(){a.name=$(this).find(".modal-title").text();for(var t in n)e=n[t],a[e]=$(this).find("td[name="+e+"]").text()}),$("#changeBox").each(function(){$(this).find("input[name=_id]").val(t),$(this).find(".modal-title").text(a.name);for(var i in n)e=n[i],$(this).find("[name="+e+"]").val(a[e]);$(this).modal("toggle")})}function firstLogin(){$("#flag").each(function(){changeBox($(this).text())})}$("#main").each(function(){$(".navbar-nav #list-main").addClass("active")}),$("button[name=loginSubmit]").on("click",function(t){t.preventDefault();var a=$(this).parents("form"),e=a.find("input[name=username]"),n=e.val(),i=n.indexOf("@");-1!==i&&(n=n.substring(0,i)),e.val(n.toLowerCase()),a.submit()}),$(":checkbox").on("click",function(){var t=$("input[name=search]").val();t&&($("input[name=search]").val(""),$("button[name=searchSubmit]").click()),0===$("input:checkbox:not(:checked)").length?$("#checkAll").addClass("active"):$("#checkAll").removeClass("active"),contactFilter(),color()}),$("#checkAll").on("click",function(){$(this).addClass("active"),$(":checkbox").each(function(){$(this).prop("checked","true")}),contactFilter(),color()}),$("input[name=search]").keyup(function(){var t=$("input[name=search]").val(),a=new RegExp(t,"i"),e=!1;$("table.main-table > tbody > tr").each(function(){e=!1,$(this).children().each(function(){a.test($(this).text())&&(e=!0)}),e?$(this).removeClass("hidden"):$(this).addClass("hidden")}),color()}),$(".author").tooltip(),$("button[name=update]").on("click",function(){$("#changeBox form").submit()}),$(".nameCard button[name=change]").on("click",function(){$(this).parents(".nameCard").modal("hide");var t=$(this).attr("data-id"),a=function(){changeBox(t)};setTimeout(a,600)}),$("#csv, #xlsx, #xls").on("click",function(){var t=$("form#export"),a=0,e='<input name = "type" value = "'+$(this).attr("id")+'">';t.append(e),$(".main-table tbody tr").each(function(){if(!$(this).hasClass("hidden")&&!$(this).hasClass("filterHidden")){var e=$(this).attr("data-id"),n='<input name = "'+a+'" value = "'+e+'">';a++,t.append(n)}}),t.submit(),t.find("input").remove()}),$("#main").each(function(){$("#navExport").removeClass("hidden")}),$(document).ready(function(){contactFilter(),color(),firstLogin()});