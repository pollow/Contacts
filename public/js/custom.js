function color(){var t=0;$(".main-table > tbody > tr").each(function(){$(this).removeClass("strip"),$(this).hasClass("hidden")||$(this).hasClass("filterHidden")||t++%2&&$(this).addClass("strip")})}function contactFilter(){var t=$("input:checked"),a={sex:{male:"男",female:"女"},grade:{one:"大一",two:"大二",three:"大三",four:"大四",master:"研究生",work:"工作"},group:{TG:"TG",OG:"OG",CG:"CG",PG:"PG"},campus:{zijingang:"紫金港",yuquan:"玉泉",xixi:"西溪",huajiachi:"华家池",zhijiang:"之江"}},n=new Object,e,i=!1,o,r=Array("sex","grade","group","campus"),c;for(index in r)c=r[index],n[c]=Array();t.each(function(){e=$(this).parents(".filterbox").attr("id"),n[e].push($(this).val())}),$("table.basic-table > tbody").each(function(){o=$(this).parents(".nameCard").attr("id");for(pIndex in r)if(i=!1,c=r[pIndex],$(this).find("td[name="+c+"]").each(function(){for(var t=0;t<n[c].length;t++){var e=n[c][t];(a[c][e]==$(this).text()||""==$(this).text())&&(i=!0)}}),!i)break;i?$("tr[data-target=#"+o+"]").removeClass("filterHidden"):$("tr[data-target=#"+o+"]").addClass("filterHidden")})}function firstLogin(){$("#flag").each(function(){changeBox($(this).text())})}function changeBox(t){var a=new Array,n,e=Array("sid","sex","major","grade","campus","enrollTime","group","nickname","longNumber","shortNumber","email","qq");$("#"+t).each(function(){a.name=$(this).find(".modal-title").text();for(var t in e)n=e[t],a[n]=$(this).find("td[name="+n+"]").text()}),$("#changeBox").each(function(){$(this).find("input[name=_id]").val(t),$(this).find(".modal-title").text(a.name);for(var i in e)n=e[i],$(this).find("[name="+n+"]").val(a[n]);$(this).modal("toggle")})}$(document).ready(function(){contactFilter(),color(),firstLogin()}),$("#main").each(function(){$(".navbar-nav #list-main").addClass("active")}),$("#index form").on("submit",function(){var t=$(this).find("input[name=username]"),a=t.val(),n=a.indexOf("@");-1!==n&&(a=a.substring(0,n),t.val(a))}),$(":checkbox").on("click",function(){var t=$("input[name=search]").val();t&&($("input[name=search]").val(""),$("button[name=searchSubmit]").click()),contactFilter(),color(),$("#checkAll").removeClass("active")}),$("#checkAll").on("click",function(){$(this).addClass("active"),$(":checkbox").each(function(){$(this).prop("checked","true")}),contactFilter(),color()}),$("input[name=search]").keyup(function(){var t=$("input[name=search]").val(),a=new RegExp(t,"i"),n=!1;$("table.main-table > tbody > tr").each(function(t){n=!1,$(this).children().each(function(){a.test($(this).text())&&(n=!0)}),n?$(this).removeClass("hidden"):$(this).addClass("hidden")}),color()}),$(".author").tooltip(),$("button[name=update]").on("click",function(){console.log($("#changeBox form")),$("#changeBox form").submit()}),$(".nameCard button[name=change]").on("click",function(){$(this).parents(".nameCard").modal("hide");var t=$(this).attr("data-id"),a=function(){changeBox(t)};setTimeout(a,600)}),$("#csv, #xlsx, #xls").on("click",function(){var t=$("form#export"),a=0,n='<input name = "type" value = "'+$(this).attr("id")+'">';t.append(n),$(".main-table tbody tr").each(function(){if(!$(this).hasClass("hidden")&&!$(this).hasClass("filterHidden")){var n=$(this).attr("data-id"),e='<input name = "'+a+'" value = "'+n+'">';a++,t.append(e)}}),t.submit(),t.find("input").remove()}),$("#main").each(function(){$("#navExport").removeClass("hidden")});