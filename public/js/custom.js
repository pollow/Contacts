function color(){var t=0;$(".main-table > tbody > tr").each(function(){$(this).removeClass("strip"),$(this).hasClass("hidden")||$(this).hasClass("filterHidden")||t++%2&&$(this).addClass("strip")})}function contactFilter(){if($("#checkAll").hasClass("active"))return void $("table.basic-table > tbody").each(function(){var t=$(this).parents(".nameCard").attr("id");$("tr[data-target=#"+t+"]").removeClass("filterHidden")});var t=$("input:checked"),a={sex:{male:"男",female:"女",unknown:""},grade:{one:"大一",two:"大二",three:"大三",four:"大四",master:"研究生",work:"工作",unknown:""},group:{TG:"TG",OG:"OG",CG:"CG",PG:"PG",unknown:""},campus:{zijingang:"紫金港",yuquan:"玉泉",xixi:"西溪",huajiachi:"华家池",zhijiang:"之江",unknown:""}},e={},n,i,o=["sex","grade","group","campus"],r;for(var c in o)r=o[c],e[r]=[];t.each(function(){n=$(this).parents(".filterbox").attr("id"),e[n].push($(this).val())}),$("table.basic-table > tbody").each(function(){i=$(this).parents(".nameCard").attr("id");var t=$(this),n=o.every(function(n){var i=t.find("td[name="+n+"]").text();return e[n].some(function(t){return a[n][t]===i})});n?$("tr[data-target=#"+i+"]").removeClass("filterHidden"):$("tr[data-target=#"+i+"]").addClass("filterHidden")})}function changeBox(t){var a=["sid","sex","major","grade","campus","enrollTime","group","nickname","longNumber","shortNumber","email","qq"],e=$("#"+t),n=$("#changeBox");n.find("input[name=_id]").val(t),n.find(".modal-title").text(e.find(".modal-title").text()),a.forEach(function(t){n.find("[name="+t+"]").val(e.find("td[name="+t+"]").text())}),n.modal("toggle")}function firstLogin(){0!==$("#flag").length&&changeBox($("#flag").text())}$("#main #list-main").addClass("active"),$("button[name=loginSubmit]").on("click",function(t){t.preventDefault();var a=$(this).parents("form"),e=a.find("input[name=username]"),n=e.val(),i=n.indexOf("@");-1!==i&&(n=n.substring(0,i)),e.val(n.toLowerCase()),a.submit()}),$(":checkbox").on("click",function(){var t=$("input[name=search]").val();t&&$("input[name=search]").val(""),0===$("input:checkbox:not(:checked)").length?$("#checkAll").addClass("active"):$("#checkAll").removeClass("active"),contactFilter(),color()}),$("#checkAll").on("click",function(){$(this).addClass("active"),$(":checkbox").each(function(){$(this).prop("checked","true")}),contactFilter(),color()}),$("input[name=search]").keyup(function(){var t=$("input[name=search]").val(),a=new RegExp(t,"i");$("table.main-table > tbody > tr").each(function(){var t=$(this).children().filter(function(t,e){return a.test($(e).text())}).length>0;t?$(this).removeClass("hidden"):$(this).addClass("hidden")}),color()}),$(".author").tooltip(),$("button[name=update]").on("click",function(){$("#changeBox form").submit()}),$(".nameCard button[name=change]").on("click",function(){$(this).parents(".nameCard").modal("hide");var t=$(this).attr("data-id"),a=function(){changeBox(t)};setTimeout(a,600)}),$("#csv, #xlsx, #xls").on("click",function(){var t=$("form#export"),a=0,e='<input name = "type" value = "'+$(this).attr("id")+'">';t.append(e),$(".main-table tbody tr").each(function(){if(!$(this).hasClass("hidden")&&!$(this).hasClass("filterHidden")){var e=$(this).attr("data-id"),n='<input name = "'+a+'" value = "'+e+'">';a++,t.append(n)}}),t.submit(),t.find("input").remove()}),$("#main #navExport").removeClass("hidden"),$(document).ready(function(){contactFilter(),color(),firstLogin()});